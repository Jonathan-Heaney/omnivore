{# notifications.html #}
{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}  {# add this #}

{% block title %}Notifications Â· Omnivore{% endblock %}

{% block content %}
<section class="container-narrow py-4">
  <h1 class="page-title">Notifications</h1>

  {% if unread_notifications %}
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="h6 text-uppercase text-muted mb-0">Unread</h2>
      <form action="{% url 'mark_all_notifications_read' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-secondary btn-sm">
          Mark all as read
        </button>
      </form>
    </div>

    <ul class="list-unstyled mb-5">
      {% for notification in unread_notifications %}
        <li class="notification-card unread mb-3">
          <a href="{% url 'notification_redirect' notification.id %}" class="stretched-link"></a>
          <div class="d-flex justify-content-between align-items-center gap-3">
            <div>{% include "main/_notification_line.html" with n=notification %}</div>
            <time class="timestamp text-muted"
                  datetime="{{ notification.timestamp|date:'c' }}">
              {{ notification.timestamp|recency_stamp }}
            </time>
          </div>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if read_notifications %}
    <h2 class="h6 text-uppercase text-muted mb-3">Earlier</h2>
    <ul class="list-unstyled">
      {% for notification in read_notifications %}
        <li class="notification-card read mb-2">
          <a href="{% url 'notification_redirect' notification.id %}" class="stretched-link"></a>
          <div class="d-flex justify-content-between align-items-center gap-3">
            <div>{% include "main/_notification_line.html" with n=notification %}</div>
            <time class="timestamp text-muted"
                  datetime="{{ notification.timestamp|date:'c' }}">
              {{ notification.timestamp|recency_stamp }}
            </time>
          </div>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if not unread_notifications and not read_notifications %}
    <p class="text-muted">No notifications yet.</p>
  {% endif %}
</section>
{% endblock %}